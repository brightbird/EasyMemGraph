# å¿†è¯­ (YiYu) - æ™ºèƒ½å¯¹è¯è®°å¿†ç³»ç»Ÿ

[![Python 3.11](https://img.shields.io/badge/python-3.11-blue.svg)](https://www.python.org/downloads/)
[![Streamlit](https://img.shields.io/badge/Streamlit-1.28+-red.svg)](https://streamlit.io/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![LangSmith](https://img.shields.io/badge/LangSmith-Integrated-green.svg)](https://smith.langchain.com/)

> å¿†è¯­ - è®©æ¯å¥è¯éƒ½æœ‰è®°å¿†

<div align="center">

![å¿†è¯­ (YiYu)](https://img.shields.io/badge/å¿†è¯­(YiYu)-æ™ºèƒ½å¯¹è¯è®°å¿†ç³»ç»Ÿ-purple?style=for-the-badge&logo=brain&logoColor=white)

åŸºäº LangGraphã€æœ¬åœ° Qdrant å‘é‡æ•°æ®åº“ã€Mem0ã€æœ¬åœ°åµŒå…¥æ¨¡å‹å’Œ LangSmith çš„æ™ºèƒ½å¯¹è¯è®°å¿†ç³»ç»Ÿï¼Œå…·å¤‡è·¨ä¼šè¯è®°å¿†åŠŸèƒ½å’Œå®Œæ•´çš„å¯¹è¯æµç¨‹è¿½è¸ªã€‚

</div>

## âœ¨ ç‰¹æ€§

- ğŸ§  **è·¨ä¼šè¯è®°å¿†**: ä½¿ç”¨ Mem0 ç®¡ç†ç”¨æˆ·å¯¹è¯å†å²å’Œåå¥½
- ğŸ” **æœ¬åœ°åµŒå…¥**: åŸºäº M3E-Base ä¸­æ–‡å‘é‡æ¨¡å‹çš„è¯­ä¹‰æœç´¢
- ğŸ¤– **é­”æ­æ¨¡å‹**: é›†æˆé­”æ­ç¤¾åŒº DeepSeek-V3.1 æ¨¡å‹
- ğŸ“Š **æœ¬åœ°å­˜å‚¨**: ä½¿ç”¨ Qdrant æœ¬åœ°å‘é‡æ•°æ®åº“ (768ç»´)
- ğŸ”„ **çŠ¶æ€ç®¡ç†**: åŸºäº LangGraph çš„æµå¼å¯¹è¯
- ğŸ‘¥ **æ™ºèƒ½ç”¨æˆ·ç®¡ç†**: è‡ªåŠ¨ä»æ•°æ®åº“åŠ è½½å·²æœ‰ç”¨æˆ·ï¼Œæ”¯æŒç”¨æˆ·åˆ†ç±»å’Œç»Ÿè®¡
- ğŸ” **ç”¨æˆ·éš”ç¦»**: æ”¯æŒå¤šç”¨æˆ·ç‹¬ç«‹è®°å¿†ç©ºé—´
- ğŸ“ˆ **å¯¹è¯è¿½è¸ª**: é›†æˆ LangSmith å®ç°å®Œæ•´çš„å¯¹è¯æµç¨‹è¿½è¸ªå’Œè°ƒè¯•
- ğŸŒ **Webç•Œé¢**: åŸºäº Streamlit çš„ç°ä»£åŒ–Webäº¤äº’ç•Œé¢
- ğŸ’¬ **ä¼šè¯ç®¡ç†**: æ”¯æŒå¤šä¼šè¯åˆ›å»ºã€ä¿å­˜ã€åˆ‡æ¢å’Œåˆ é™¤
- ğŸ“‹ **è®°å¿†å¼•ç”¨**: å¯å±•å¼€æŸ¥çœ‹å¯¹è¯ä¸­çš„è®°å¿†å¼•ç”¨è¯¦æƒ…
- ğŸ› **è°ƒè¯•å·¥å…·**: æä¾›å¼ºå¤§çš„è°ƒè¯•å’Œæ€§èƒ½åˆ†æå·¥å…·
- ğŸš€ **æ— é™çº§å¤„ç†**: ä¸¥æ ¼æŒ‰ç…§è¦æ±‚å®ç°ï¼Œæ— å¤‡ç”¨æ–¹æ¡ˆ

## ğŸš€ å¿«é€Ÿé¢„è§ˆ

<div align="center">

### ğŸŒ Webç•Œé¢æ¼”ç¤º
![Webç•Œé¢](https://img.shields.io/badge/Streamlit-ç°ä»£åŒ–ç•Œé¢-FF4B4B?style=flat-square&logo=streamlit&logoColor=white)

### ğŸ“± æ ¸å¿ƒåŠŸèƒ½
- ğŸ§  **æ™ºèƒ½è®°å¿†**: è·¨ä¼šè¯å¯¹è¯è®°å¿†ç®¡ç†
- ğŸ‘¥ **å¤šç”¨æˆ·æ”¯æŒ**: ç‹¬ç«‹çš„ç”¨æˆ·è®°å¿†ç©ºé—´
- ğŸ” **è¯­ä¹‰æœç´¢**: åŸºäºM3Eå‘é‡çš„æ™ºèƒ½æ£€ç´¢
- ğŸ“Š **å®æ—¶è¿½è¸ª**: LangSmithå®Œæ•´çš„å¯¹è¯ç›‘æ§

</div>

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒå¯¹è¯æ¶æ„
```
LangGraph (å¯¹è¯çŠ¶æ€ç®¡ç†)
    â†“
Mem0 (è®°å¿†ç®¡ç†)
    â†“
HuggingFace M3E-Base (æœ¬åœ°åµŒå…¥æ¨¡å‹)
    â†“
Qdrant (æœ¬åœ°å‘é‡æ•°æ®åº“)
    â†“
ModelScope DeepSeek-V3.1 (LLMå¯¹è¯)
    â†“
LangSmith (å¯¹è¯æµç¨‹è¿½è¸ªå’Œè°ƒè¯•)
```

### ç”¨æˆ·ç®¡ç†æ¶æ„
```
åº”ç”¨å¯åŠ¨
    â†“
æ‰«æ Qdrant å‘é‡æ•°æ®åº“
    â†“
æå–å·²æœ‰ç”¨æˆ·IDåˆ—è¡¨
    â†“
åˆ†ç±»ç”¨æˆ· (æ•°æ®åº“ç”¨æˆ·/æœ¬åœ°ç”¨æˆ·)
    â†“
åŠ è½½åˆ° Streamlit Session State
    â†“
æä¾›ç”¨æˆ·ç•Œé¢ç®¡ç†
    â†“
åŠ¨æ€åˆ›å»º/åˆ é™¤ç”¨æˆ·
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone <your-repo-url>
cd å¿†è¯­-YiYu  # æˆ– EasyMemGraph

# åˆ›å»º Python 3.11 è™šæ‹Ÿç¯å¢ƒ
python3.11 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate  # Linux/macOS
# æˆ– venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„é…ç½®
# å¿…é¡»é…ç½® MODELSCOPE_API_KEY å’Œ LANGCHAIN_API_KEY
```

**å…³é”®é…ç½®é¡¹**:
```bash
# å¿…é¡»é…ç½®çš„å‚æ•°
MODELSCOPE_API_KEY=your-modelscope-api-key-here
LANGCHAIN_API_KEY=your-langsmith-api-key-here

# å…¶ä»–æ¨èé…ç½®
EMBEDDING_MODEL=moka-ai/m3e-base  # æœ¬åœ°åµŒå…¥æ¨¡å‹
EMBEDDING_DIMS=768               # å‘é‡ç»´åº¦
LANGCHAIN_PROJECT=YiYu   # LangSmith é¡¹ç›®åç§°
```

### 3. å¯åŠ¨ Qdrant æœåŠ¡

```bash
# è‡ªåŠ¨è®¾ç½® Qdrant (æ¨è)
python setup_qdrant.py

# æˆ–æ‰‹åŠ¨å¯åŠ¨ Docker å®¹å™¨
docker run -d --name qdrant-memory-agent \
  -p 6333:6333 -p 6334:6334 \
  -v $(pwd)/qdrant_storage:/qdrant/storage \
  qdrant/qdrant:latest
```

### 4. åˆ›å»º LangSmith é¡¹ç›®ï¼ˆå¯é€‰ï¼‰

```bash
# è‡ªåŠ¨åˆ›å»º YiYu é¡¹ç›®
python create_project.py

# æˆ–ä½¿ç”¨äº¤äº’å¼è®¾ç½®å·¥å…·
python setup_langsmith_project.py
```

### 5. å¯åŠ¨å¯¹è¯æœºå™¨äºº

æ‚¨å¯ä»¥é€‰æ‹©ä½¿ç”¨å‘½ä»¤è¡Œç•Œé¢æˆ–Webç•Œé¢ï¼š

#### é€‰é¡¹1: å‘½ä»¤è¡Œç•Œé¢
```bash
python memory_agent.py
```

#### é€‰é¡¹2: Webç•Œé¢ (æ¨è)
```bash
streamlit run app.py
```

å¿†è¯­ Webç•Œé¢å°†åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œé»˜è®¤åœ°å€ä¸º `http://localhost:8501`

## ğŸ“ é¡¹ç›®ç»“æ„

```bash
å¿†è¯­ (YiYu)/
â”œâ”€â”€ ğŸ“„ app.py                     # Streamlit Webåº”ç”¨ä¸»æ–‡ä»¶ (æ™ºèƒ½ç”¨æˆ·ç®¡ç†)
â”œâ”€â”€ ğŸ“„ memory_agent.py            # ä¸»å¯¹è¯ä»£ç† (å¸¦ LangSmith è¿½è¸ª)
â”œâ”€â”€ ğŸ“„ config.py                  # ç»Ÿä¸€é…ç½®ç®¡ç†
â”œâ”€â”€ ğŸ“„ setup_qdrant.py            # Qdrant å‘é‡æ•°æ®åº“è®¾ç½®è„šæœ¬
â”œâ”€â”€ ğŸ“„ langsmith_debug.py         # LangSmith è°ƒè¯•å’Œç›‘æ§å·¥å…·
â”œâ”€â”€ ğŸ“„ setup_langsmith_project.py # LangSmith é¡¹ç›®è®¾ç½®å·¥å…·
â”œâ”€â”€ ğŸ“„ requirements.txt           # ä¾èµ–åŒ…åˆ—è¡¨ (å« streamlit)
â”œâ”€â”€ ğŸ“„ .env.example              # ç¯å¢ƒå˜é‡é…ç½®æ¨¡æ¿
â”œâ”€â”€ ğŸ“„ README.md                 # é¡¹ç›®å®Œæ•´æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ CLAUDE.md                 # å¼€å‘ç¯å¢ƒæŒ‡å—
â”œâ”€â”€ ğŸ“„ qdrant_storage/           # Qdrant æœ¬åœ°å­˜å‚¨ç›®å½•
â”œâ”€â”€ ğŸ“„ .gitignore               # Gitå¿½ç•¥æ–‡ä»¶
â””â”€â”€ ğŸ“„ LICENSE                  # MITè®¸å¯è¯
```

### ğŸ“Š é¡¹ç›®ç»Ÿè®¡
- **ä»£ç æ–‡ä»¶**: 6ä¸ªæ ¸å¿ƒPythonæ–‡ä»¶
- **æ€»ä»£ç è¡Œæ•°**: ~2000è¡Œ
- **ä¾èµ–åŒ…**: 25ä¸ªPythonåŒ…
- **æ¨¡å‹å¤§å°**: ~400MB (M3E-Base)
- **æ•°æ®åº“**: æœ¬åœ°Qdrantå‘é‡å­˜å‚¨

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ | å¿…å¡« |
|--------|------|--------|------|
| `MODELSCOPE_API_KEY` | é­”æ­ç¤¾åŒº API å¯†é’¥ | - | âœ… |
| `LANGCHAIN_API_KEY` | LangSmith API å¯†é’¥ | - | âœ… |
| `MODEL_NAME` | LLM æ¨¡å‹åç§° | `deepseek-ai/DeepSeek-V3.1` | âŒ |
| `EMBEDDING_MODEL` | æœ¬åœ°åµŒå…¥æ¨¡å‹ | `moka-ai/m3e-base` | âŒ |
| `EMBEDDING_DIMS` | å‘é‡ç»´åº¦ | `768` | âŒ |
| `QDRANT_URL` | Qdrant æœåŠ¡åœ°å€ | `http://localhost:6333` | âŒ |
| `QDRANT_COLLECTION_NAME` | é›†åˆåç§° | `conversation_memories` | âŒ |
| `LANGCHAIN_PROJECT` | LangSmith é¡¹ç›®åç§° | `YiYu` | âŒ |
| `LANGCHAIN_TRACING_V2` | å¯ç”¨ LangSmith è¿½è¸ª | `true` | âŒ |
| `LANGCHAIN_ENDPOINT` | LangSmith æœåŠ¡åœ°å€ | `https://api.smith.langchain.com` | âŒ |

### æ¨¡å‹é…ç½®

**LLM æ¨¡å‹**: é­”æ­ç¤¾åŒº DeepSeek-V3.1
**åµŒå…¥æ¨¡å‹**: æœ¬åœ° M3E-Base ä¸­æ–‡åµŒå…¥æ¨¡å‹ (768ç»´)
**å‘é‡æ•°æ®åº“**: æœ¬åœ° Qdrant (Cosine è·ç¦»)

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### Webç•Œé¢ä½¿ç”¨ (æ¨è)

```bash
streamlit run app.py
```

Webç•Œé¢åŠŸèƒ½ç‰¹æ€§ï¼š

1. **ä¼šè¯ç®¡ç†**: å·¦ä¾§è¾¹æ å¯åˆ›å»ºã€åˆ‡æ¢ã€åˆ é™¤ä¼šè¯
2. **æ™ºèƒ½ç”¨æˆ·ç®¡ç†**: è‡ªåŠ¨åŠ è½½å’Œåˆ†ç±»ç®¡ç†ç”¨æˆ·
3. **äº¤äº’å¯¹è¯**: ä¸»ç•Œé¢æ”¯æŒå®æ—¶å¯¹è¯ï¼Œæ¶ˆæ¯æŒ‰æ—¶é—´é¡ºåºæ˜¾ç¤º
4. **è®°å¿†å¼•ç”¨**: AIå›å¤ä¸‹æ–¹å¯ç‚¹å‡»"å¿†è¯­å¼•ç”¨"å±•å¼€ç›¸å…³è®°å¿†è¯¦æƒ…
5. **å“åº”å¼è®¾è®¡**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸ï¼Œç§»åŠ¨ç«¯å‹å¥½

### ğŸ‘¥ æ™ºèƒ½ç”¨æˆ·ç®¡ç†åŠŸèƒ½

å¿†è¯­æ”¯æŒå¼ºå¤§çš„ç”¨æˆ·ç®¡ç†åŠŸèƒ½ï¼Œè‡ªåŠ¨è¯†åˆ«å’Œåˆ†ç±»ç”¨æˆ·ï¼š

#### ğŸ†” ç”¨æˆ·ç±»å‹
- **ğŸ—„ï¸ æ•°æ®åº“ç”¨æˆ·**: å·²æœ‰å¯¹è¯è®°å¿†çš„ç”¨æˆ·ï¼Œä»Qdrantå‘é‡æ•°æ®åº“è‡ªåŠ¨åŠ è½½
- **ğŸ‘¤ æœ¬åœ°ç”¨æˆ·**: æ–°åˆ›å»ºä½†æš‚æ— å¯¹è¯è®°å¿†çš„ç”¨æˆ·
- **ğŸŸ¢ å½“å‰ç”¨æˆ·**: å®æ—¶çŠ¶æ€æŒ‡ç¤ºå™¨æ˜¾ç¤ºå½“å‰æ´»è·ƒç”¨æˆ·

#### ğŸ“Š ç”¨æˆ·ç»Ÿè®¡ä¿¡æ¯
- **æ€»ç”¨æˆ·æ•°**: æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·çš„æ€»æ•°
- **è®°å¿†æ•°é‡**: æ¯ä¸ªç”¨æˆ·çš„å¯¹è¯è®°å¿†æ¡æ•°
- **æœ€åæ´»è·ƒ**: ç”¨æˆ·æœ€è¿‘çš„å¯¹è¯æ—¶é—´
- **ç”¨æˆ·åˆ†ç±»**: è‡ªåŠ¨åŒºåˆ†æœ‰æ•°æ®/æ— æ•°æ®ç”¨æˆ·

#### ğŸš€ ç”¨æˆ·æ“ä½œ
- **é€‰æ‹©ç”¨æˆ·**: ä»ä¸‹æ‹‰èœå•å¿«é€Ÿåˆ‡æ¢ç”¨æˆ·èº«ä»½
- **åˆ›å»ºç”¨æˆ·**: ç‚¹å‡»"+ â• æ–°å»ºç”¨æˆ·ID"åˆ›å»ºæ–°ç”¨æˆ·
- **åˆ é™¤ç”¨æˆ·**: åœ¨ç”¨æˆ·ç®¡ç†é¢æ¿ä¸­åˆ é™¤ä¸éœ€è¦çš„ç”¨æˆ·
- **è‡ªåŠ¨ä¿å­˜**: æ–°ç”¨æˆ·è‡ªåŠ¨æ·»åŠ åˆ°ç”¨æˆ·å†å²è®°å½•

**ä½¿ç”¨æ­¥éª¤**:
1. å¯åŠ¨Webåº”ç”¨åï¼Œç³»ç»Ÿè‡ªåŠ¨æ‰«æå¹¶åŠ è½½æ‰€æœ‰å·²æœ‰ç”¨æˆ·
2. åœ¨å·¦ä¾§"ğŸ†” é€‰æ‹©ç”¨æˆ·ID"ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©ç”¨æˆ·
3. åˆ›å»ºæ–°ç”¨æˆ·ï¼šç‚¹å‡»"+ â• æ–°å»ºç”¨æˆ·ID"ï¼Œè¾“å…¥ç”¨æˆ·åå¹¶åˆ›å»º
4. åœ¨"ğŸ‘¥ ç”¨æˆ·ç®¡ç†"ä¸­æŸ¥çœ‹è¯¦ç»†çš„ç”¨æˆ·ç»Ÿè®¡ä¿¡æ¯
5. åœ¨åº•éƒ¨è¾“å…¥æ¡†è¾“å…¥æ¶ˆæ¯ï¼Œç‚¹å‡»å‘é€æˆ–æŒ‰Enterå¼€å§‹å¯¹è¯
6. æŸ¥çœ‹AIå›å¤ï¼Œç‚¹å‡»"å¿†è¯­å¼•ç”¨"äº†è§£è®°å¿†è¯¦æƒ…
7. å¯éšæ—¶åˆ‡æ¢ç”¨æˆ·èº«ä»½ï¼Œæ¯ä¸ªç”¨æˆ·æ‹¥æœ‰ç‹¬ç«‹çš„è®°å¿†ç©ºé—´

### å‘½ä»¤è¡Œç•Œé¢

```bash
python memory_agent.py
```

å¯åŠ¨åï¼Œæ‚¨å¯ä»¥ï¼š

1. è¾“å…¥ç”¨æˆ·ID (å¯é€‰ï¼Œé»˜è®¤ä¸º default_user)
2. å¼€å§‹å¯¹è¯ï¼Œç³»ç»Ÿä¼šè®°ä½æ‚¨çš„å¯¹è¯å†å²
3. è¾“å…¥ `quit`ã€`exit` æˆ– `bye` é€€å‡º

### ç¨‹åºåŒ–è°ƒç”¨

```python
from memory_agent import run_conversation

# å•æ¬¡å¯¹è¯
response = run_conversation("ä½ å¥½ï¼Œæˆ‘æƒ³äº†è§£ä¸€ä¸‹ä½ çš„åŠŸèƒ½", "user123")

# å¤šè½®å¯¹è¯ (è·¨ä¼šè¯è®°å¿†)
response1 = run_conversation("æˆ‘å«å¼ ä¸‰ï¼Œå–œæ¬¢ç¼–ç¨‹å’ŒAI", "user123")
response2 = run_conversation("ä½ è¿˜è®°å¾—æˆ‘çš„åå­—å’Œçˆ±å¥½å—ï¼Ÿ", "user123")  # ä¼šè®°ä½ä¹‹å‰çš„å¯¹è¯
```

### æµ‹è¯•é¡¹ç›®

```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ (å« LangSmith éªŒè¯)
python test_agent.py

# æµ‹è¯•å†…å®¹åŒ…æ‹¬ï¼š
# - åŸºæœ¬è‡ªæˆ‘ä»‹ç»å’Œè®°å¿†å­˜å‚¨
# - è·¨ä¼šè¯è®°å¿†æ£€ç´¢
# - ç”¨æˆ·éš”ç¦»éªŒè¯
# - åå¥½è®°å¿†åŠŸèƒ½
# - LangSmith è¿½è¸ªæ•°æ®éªŒè¯
# - è°ƒè¯•å·¥å…·åŠŸèƒ½æµ‹è¯•
```

## ğŸ”§ å¼€å‘æŒ‡å—

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **æ— é™çº§å¤„ç†**: æ‰€æœ‰ç»„ä»¶å¿…é¡»æŒ‰é…ç½®æ­£å¸¸å·¥ä½œï¼Œæ— å¤‡ç”¨æ–¹æ¡ˆ
2. **æœ¬åœ°ä¼˜å…ˆ**: åµŒå…¥æ¨¡å‹å’Œå‘é‡æ•°æ®åº“ä¼˜å…ˆä½¿ç”¨æœ¬åœ°éƒ¨ç½²
3. **ç”¨æˆ·éš”ç¦»**: ä¸åŒç”¨æˆ·çš„è®°å¿†æ•°æ®å®Œå…¨åˆ†ç¦»
4. **çŠ¶æ€ä¸€è‡´æ€§**: ä½¿ç”¨ LangGraph ç¡®ä¿å¯¹è¯çŠ¶æ€çš„ä¸€è‡´æ€§
5. **æ™ºèƒ½ç”¨æˆ·ç®¡ç†**: è‡ªåŠ¨å‘ç°å’Œç®¡ç†ç”¨æˆ·ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®
6. **æ··åˆå­˜å‚¨**: ç»“åˆæ•°æ®åº“æŒä¹…åŒ–å’Œå†…å­˜ç¼“å­˜ï¼Œæå‡æ€§èƒ½

### ç”¨æˆ·ç®¡ç†ç³»ç»Ÿæ¶æ„

å¿†è¯­é‡‡ç”¨æ··åˆç”¨æˆ·ç®¡ç†æ–¹æ¡ˆï¼Œç»“åˆæ•°æ®åº“æ‰«æå’Œå†…å­˜ç¼“å­˜ï¼š

```python
# ç”¨æˆ·æ‰«ææµç¨‹
def scan_existing_users() -> set:
    """ä»Qdrantæ‰«æå·²æœ‰ç”¨æˆ·"""
    - è¿æ¥åˆ°Qdrantå‘é‡æ•°æ®åº“
    - æ‰¹é‡æ‰«ææ‰€æœ‰è®°å½•
    - æå–user_idå­—æ®µ
    - è¿”å›å”¯ä¸€ç”¨æˆ·é›†åˆ

# ç”¨æˆ·ç»Ÿè®¡æµç¨‹
def get_user_statistics(user_id: str) -> Dict:
    """è·å–ç”¨æˆ·è¯¦ç»†ç»Ÿè®¡"""
    - æŸ¥è¯¢ç”¨æˆ·è®°å¿†æ•°é‡
    - è·å–æœ€åæ´»è·ƒæ—¶é—´
    - ç»Ÿè®¡å¯¹è¯æ¬¡æ•°
    - è¿”å›ç”¨æˆ·ç”»åƒä¿¡æ¯
```

**ç”¨æˆ·åˆ†ç±»ç­–ç•¥**:
- **æ•°æ®åº“ç”¨æˆ·**: é€šè¿‡Qdrantæ‰«æå‘ç°çš„æœ‰å†å²æ•°æ®çš„ç”¨æˆ·
- **æœ¬åœ°ç”¨æˆ·**: ä¼šè¯æœŸé—´åˆ›å»ºä½†å°šæœªæœ‰å¯¹è¯æ•°æ®çš„æ–°ç”¨æˆ·
- **é»˜è®¤ç”¨æˆ·**: `web_user` ä½œä¸ºè®¿å®¢æ¨¡å¼çš„é»˜è®¤æ ‡è¯†

**ç¼“å­˜æœºåˆ¶**:
- é¦–æ¬¡å¯åŠ¨æ—¶å…¨é‡æ‰«ææ•°æ®åº“
- ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨Session Stateä¸­
- é¿å…é‡å¤æ‰«æï¼Œæå‡æ€§èƒ½
- æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€æ·»åŠ æ–°ç”¨æˆ·

### è®°å¿†ç³»ç»Ÿæ¶æ„

```python
# è®°å¿†å­˜å‚¨æ ¼å¼
interaction = [
    {
        "role": "user",
        "content": "ç”¨æˆ·è¾“å…¥å†…å®¹"
    },
    {
        "role": "assistant",
        "content": "AIå›åº”å†…å®¹"
    }
]

# è®°å¿†æ£€ç´¢é…ç½®
memories = memory.search(
    query=user_message,
    user_id=user_id,
    limit=5  # è¿”å›æœ€ç›¸å…³çš„5æ¡è®°å¿†
)
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è™šæ‹Ÿç¯å¢ƒé—®é¢˜**
   ```bash
   # ç¡®ä¿ä½¿ç”¨ Python 3.11
   python3.11 --version

   # é‡æ–°åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
   rm -rf venv
   python3.11 -m venv venv
   source venv/bin/activate
   pip install -r requirements.txt
   ```

2. **Qdrant è¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥ Qdrant æ˜¯å¦è¿è¡Œ
   curl http://localhost:6333/collections

   # é‡æ–°è®¾ç½® Qdrant
   python setup_qdrant.py
   ```

3. **åµŒå…¥æ¨¡å‹é—®é¢˜**
   - M3E-Base æ¨¡å‹é¦–æ¬¡ä½¿ç”¨æ—¶ä¼šè‡ªåŠ¨ä¸‹è½½ (çº¦ 400MB)
   - ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´å’Œç½‘ç»œè¿æ¥
   - æ¨¡å‹ä¸‹è½½åä¿å­˜åœ¨ HuggingFace ç¼“å­˜ç›®å½•

4. **LLM API è°ƒç”¨å¤±è´¥**
   - æ£€æŸ¥ `MODELSCOPE_API_KEY` æ˜¯å¦æ­£ç¡®é…ç½®
   - ç¡®è®¤ç½‘ç»œå¯ä»¥è®¿é—®é­”æ­ API
   - æŸ¥çœ‹æ¨¡å‹é…é¢å’Œä½¿ç”¨é™åˆ¶

5. **LangSmith è¿½è¸ªé—®é¢˜**
   - æ£€æŸ¥ `LANGCHAIN_API_KEY` æ˜¯å¦æ­£ç¡®é…ç½®
   - ç¡®è®¤ LangSmith é¡¹ç›®æ˜¯å¦å­˜åœ¨ (`python create_project.py`)
   - éªŒè¯ç½‘ç»œå¯ä»¥è®¿é—® LangSmith API
   - æŸ¥çœ‹ LangSmith æ§åˆ¶å°ç¡®è®¤æ•°æ®æ¥æ”¶

6. **åµŒå…¥æ¨¡å‹ç»´åº¦é”™è¯¯**
   - ç¡®ä¿ `EMBEDDING_MODEL` å’Œ `EMBEDDING_DIMS` é…ç½®åŒ¹é…
   - M3E-Base ä½¿ç”¨ 768 ç»´ï¼ŒM3E-Large ä½¿ç”¨ 1024 ç»´
   - åˆ é™¤é”™è¯¯çš„ Qdrant é›†åˆé‡æ–°å¼€å§‹

### æ—¥å¿—æŸ¥çœ‹

ç¨‹åºè¿è¡Œæ—¶ä¼šè¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š
- ğŸ”„ è®°å¿†æœç´¢ç»“æœç»Ÿè®¡
- ğŸ’¾ è®°å¿†å­˜å‚¨æ“ä½œè®°å½•
- ğŸ¤– LLM è°ƒç”¨çŠ¶æ€
- ğŸ“Š LangSmith è¿½è¸ªä¿¡æ¯
- âŒ é”™è¯¯ä¿¡æ¯å’Œè°ƒè¯•ä¿¡æ¯

## ğŸ“ API å‚è€ƒ

### Config é…ç½®ç±»

```python
from config import Config

# è·å–å®Œæ•´çš„ Mem0 é…ç½®
mem0_config = Config.get_mem0_config()

# è·å– LLM é…ç½® (é­”æ­ API)
llm_config = Config.get_model_config()

# è·å–åµŒå…¥é…ç½® (æœ¬åœ° M3E-Base)
embedding_config = Config.get_embedding_config()

# è·å– Qdrant é…ç½®
qdrant_config = Config.get_qdrant_config()
```

### å¯¹è¯ä»£ç†

```python
from memory_agent import run_conversation

# å•æ¬¡å¯¹è¯
response = run_conversation("ä½ å¥½", "user_id")

# å¸¦è®°å¿†çš„å¤šè½®å¯¹è¯
response1 = run_conversation("æˆ‘å«å¼ ä¸‰ï¼Œæ˜¯ç¨‹åºå‘˜", "user_id")
response2 = run_conversation("ä½ è¿˜è®°å¾—æˆ‘çš„èŒä¸šå—ï¼Ÿ", "user_id")
```

### è®°å¿†ç®¡ç†

```python
from mem0 import Memory
from config import Config

# åˆå§‹åŒ–è®°å¿†ç³»ç»Ÿ
memory = Memory.from_config(Config.get_mem0_config())

# æœç´¢ç”¨æˆ·è®°å¿†
memories = memory.search("æŸ¥è¯¢å†…å®¹", user_id="user_id")

# æŸ¥çœ‹è®°å¿†ç»“æœ
if memories and 'results' in memories:
    for mem in memories['results']:
        print(f"è®°å¿†: {mem['memory']}")
```

### LangSmith è°ƒè¯•å·¥å…·

```bash
# æŸ¥çœ‹è¿è¡Œè®°å½•
python langsmith_debug.py list --limit 10

# æŸ¥çœ‹ç‰¹å®šè¿è¡Œè¯¦æƒ…
python langsmith_debug.py details --run-id <run-id>

# æ€§èƒ½åˆ†æ
python langsmith_debug.py performance --hours 24

# æµ‹è¯•å¯¹è¯å¹¶è¿½è¸ª
python langsmith_debug.py test --input "æµ‹è¯•æ¶ˆæ¯" --user-id test_user

# å®æ—¶ç›‘æ§è¿è¡Œ
python langsmith_debug.py monitor --duration 5

# åˆ›å»ºæˆ–åˆ‡æ¢ LangSmith é¡¹ç›®
python create_project.py
```

## ğŸ¯ æ€§èƒ½ç‰¹æ€§

### ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡

- **åµŒå…¥æ¨¡å‹**: M3E-Base (768ç»´å‘é‡)
- **å‘é‡æœç´¢**: Cosine ç›¸ä¼¼åº¦ï¼Œæ¯«ç§’çº§å“åº”
- **è®°å¿†å­˜å‚¨**: è‡ªåŠ¨å»é‡å’Œæ›´æ–°
- **ç”¨æˆ·éš”ç¦»**: å®Œå…¨ç‹¬ç«‹çš„è®°å¿†ç©ºé—´
- **å¹¶å‘æ”¯æŒ**: å¤šç”¨æˆ·åŒæ—¶å¯¹è¯
- **ç”¨æˆ·ç®¡ç†æ€§èƒ½**: å¯åŠ¨æ—¶ä¸€æ¬¡æ€§æ‰«æï¼Œè¿è¡Œæ—¶é›¶å»¶è¿Ÿ
- **ç”¨æˆ·ç»Ÿè®¡**: å®æ—¶è·å–ç”¨æˆ·è®°å¿†æ•°é‡å’Œæ´»è·ƒçŠ¶æ€
- **è¿½è¸ªæ€§èƒ½**: LangSmith å®æ—¶è¿½è¸ªå¯¹è¯æµç¨‹
- **è°ƒè¯•æ•ˆç‡**: è¯¦ç»†çš„æ€§èƒ½åˆ†æå’Œé”™è¯¯è¯Šæ–­

### æ‰©å±•æ€§è€ƒè™‘

- æ”¯æŒè‡ªå®šä¹‰åµŒå…¥æ¨¡å‹
- å¯é…ç½®çš„è®°å¿†æœç´¢å‚æ•°
- **æ™ºèƒ½ç”¨æˆ·ç®¡ç†**: æ”¯æŒä»å¤šç§æ•°æ®æºè‡ªåŠ¨å‘ç°ç”¨æˆ·
- **ç”¨æˆ·ç»Ÿè®¡æ‰©å±•**: å¯æ‰©å±•çš„ç”¨æˆ·ç”»åƒå’Œè¡Œä¸ºåˆ†æ
- æ¨¡å—åŒ–çš„é…ç½®ç³»ç»Ÿ
- å¯æ‰©å±•çš„è¿½è¸ªåŠŸèƒ½
- è‡ªå®šä¹‰è°ƒè¯•å·¥å…·é›†æˆ

## ğŸ”’ å®‰å…¨æ€§

- API å¯†é’¥æœ¬åœ°å­˜å‚¨
- ç”¨æˆ·æ•°æ®éš”ç¦»
- æœ¬åœ°å‘é‡æ•°æ®åº“
- æ— æ•°æ®å¤–ä¼ é£é™©
- **ç”¨æˆ·éšç§ä¿æŠ¤**: ç”¨æˆ·IDå’Œè®°å¿†æ•°æ®å®Œå…¨éš”ç¦»
- **å†…å­˜ç¼“å­˜å®‰å…¨**: ç”¨æˆ·ä¿¡æ¯ä»…åœ¨ä¼šè¯æœŸé—´ç¼“å­˜
- **è®¿é—®æ§åˆ¶**: ç”¨æˆ·é—´æ•°æ®æ— æ³•äº’ç›¸è®¿é—®
- LangSmith è¿½è¸ªæ•°æ®åŠ å¯†ä¼ è¾“
- å¯é…ç½®çš„è¿½è¸ªéšç§çº§åˆ«

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘è¦æ±‚

1. ä½¿ç”¨ Python 3.11 è™šæ‹Ÿç¯å¢ƒ
2. éµå¾ªæ— é™çº§å¤„ç†åŸåˆ™
3. ä¿è¯æµ‹è¯•ç”¨ä¾‹é€šè¿‡ (å« LangSmith éªŒè¯)
4. æ›´æ–°ç›¸å…³æ–‡æ¡£
5. ç¡®ä¿ LangSmith è¿½è¸ªåŠŸèƒ½æ­£å¸¸

### æäº¤æµç¨‹

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡ (`python test_agent.py`)
4. éªŒè¯ LangSmith åŠŸèƒ½ (`python langsmith_debug.py list`)
5. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
6. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
7. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [LangGraph](https://github.com/langchain-ai/langgraph) - çŠ¶æ€ç®¡ç†æ¡†æ¶
- [Mem0](https://github.com/mem0ai/mem0) - è®°å¿†ç®¡ç†ç³»ç»Ÿ
- [Qdrant](https://github.com/qdrant/qdrant) - å‘é‡æ•°æ®åº“
- [ModelScope](https://github.com/modelscope/modelscope) - æ¨¡å‹æœåŠ¡
- [LangSmith](https://smith.langchain.com) - å¯¹è¯æµç¨‹è¿½è¸ªå’Œè°ƒè¯•å¹³å°
- [M3E](https://huggingface.co/moka-ai/m3e-base) - ä¸­æ–‡åµŒå…¥æ¨¡å‹
- [HuggingFace](https://huggingface.co) - æ¨¡å‹æ‰˜ç®¡å’Œéƒ¨ç½²

## ğŸ”— ç›¸å…³é“¾æ¥

- [LangSmith æ§åˆ¶å°](https://smith.langchain.com) - æŸ¥çœ‹å¯¹è¯è¿½è¸ªæ•°æ®
- [LANGSMITH_GUIDE.md](./LANGSMITH_GUIDE.md) - è¯¦ç»†ä½¿ç”¨æŒ‡å—
- [é­”æ­ç¤¾åŒº](https://modelscope.cn) - LLM æ¨¡å‹æœåŠ¡

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼**

[![GitHub stars](https://img.shields.io/github/stars/brightbird/EasyMemGraph.svg?style=social&label=Star)](https://github.com/brightbird/EasyMemGraph)
[![GitHub forks](https://img.shields.io/github/forks/brightbird/EasyMemGraph.svg?style=social&label=Fork)](https://github.com/brightbird/EasyMemGraph/fork)
[![GitHub issues](https://img.shields.io/github/issues/brightbird/EasyMemGraph.svg)](https://github.com/brightbird/EasyMemGraph/issues)

**ğŸ”§ ç»´æŠ¤è€…**: [brightbird](https://github.com/brightbird)
**ğŸ“… æœ€åæ›´æ–°**: 2025å¹´10æœˆ
**ğŸ“¦ ç‰ˆæœ¬**: v1.0

</div>